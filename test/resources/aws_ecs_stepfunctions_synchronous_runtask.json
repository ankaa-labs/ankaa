{
    "Comment": "Synchronous RunTask Operation",
    "StartAt": "Run Fargate Task",
    "TimeoutSeconds": 3600,
    "States": {
      "Run Fargate Task": {
        "Type": "Task",
        "Resource": "arn:aws:states:::ecs:runTask.sync",
        "Parameters": {
          "LaunchType": "FARGATE",
          "Cluster": "${ECSSampleCluster.Arn}",
          "TaskDefinition": "${SampleTaskDefinition}",
          "NetworkConfiguration": {
            "AwsvpcConfiguration": {
              "Subnets": [
                "${SamplePrivateSubnet}"
              ],
              "AssignPublicIp": "ENABLED"
            }
          }
        },
        "Retry": [
          {
            "ErrorEquals": [
              "States.ALL"
            ],
            "IntervalSeconds": 10,
            "MaxAttempts": 3,
            "BackoffRate": 2
          }
        ],
        "Next": "Notify Success",
        "Catch": [
          {
            "ErrorEquals": [
              "States.ALL"
            ],
            "Next": "Notify Failure"
          }
        ]
      },
      "Notify Success": {
        "Type": "Task",
        "Resource": "arn:aws:states:::sns:publish",
        "Parameters": {
          "Message": "AWS Fargate Task started by Step Functions succeeded",
          "TopicArn": "${SampleSnsTopic}"
        },
        "End": true
      },
      "Notify Failure": {
        "Type": "Task",
        "Resource": "arn:aws:states:::sns:publish",
        "Parameters": {
          "Message": "AWS Fargate Task started by Step Functions failed",
          "TopicArn": "${SampleSnsTopic}"
        },
        "End": true
      }
    }
  }